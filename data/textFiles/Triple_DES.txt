In cryptography , Triple DES ( 3DES or TDES ), officially the Triple Data Encryption Algorithm ( TDEA or Triple DEA ), is a symmetric-key block cipher , which applies the DES cipher algorithm three times to each data block. The 56-bit key of the Data Encryption Standard (DES) is no longer considered adequate in the face of modern cryptanalytic techniques and supercomputing power; Triple DES increases the effective security to 112 bits. A CVE released in 2016, CVE-2016-2183 , disclosed a major security vulnerability in the DES and 3DES encryption algorithms. This CVE, combined with the inadequate key size of 3DES, led to NIST deprecating 3DES in 2019 and disallowing all uses (except processing already encrypted data) by the end of 2023. It has been replaced with the more secure, more robust AES .

While US government and industry standards abbreviate the algorithm's name as TDES (Triple DES) and TDEA (Triple Data Encryption Algorithm), RFC 1851 referred to it as 3DES from the time it first promulgated the idea, and this namesake has since come into wide use by most vendors, users, and cryptographers.

In 1978, a triple encryption method using DES with two 56-bit keys was proposed by Walter Tuchman ; in 1981, Merkle and Hellman proposed a more secure triple-key version of 3DES with 112 bits of security.

The Triple Data Encryption Algorithm is variously defined in several standards documents:

The original DES cipher's key size of 56 bits was considered generally sufficient when it was designed, but the availability of increasing computational power made brute-force attacks feasible. Triple DES provides a relatively simple method of increasing the key size of DES to protect against such attacks, without the need to design a completely new block cipher algorithm.

A naive approach to increase the strength of a block encryption algorithm with a short key length (like DES) would be to use two keys ( K 1 , K 2 ) {\displaystyle (K1,K2)} instead of one, and encrypt each block twice: E K 2 ( E K 1 ( plaintext ) ) {\displaystyle E_{K2}(E_{K1}({\textrm {plaintext}}))} . If the original key length is n {\displaystyle n} bits, one would hope this scheme provides security equivalent to using a key 2 n {\displaystyle 2n} bits long. Unfortunately, this approach is vulnerable to the meet-in-the-middle attack : given a known plaintext pair ( x , y ) {\displaystyle (x,y)} , such that y = E K 2 ( E K 1 ( x ) ) {\displaystyle y=E_{K2}(E_{K1}(x))} , one can recover the key pair ( K 1 , K 2 ) {\displaystyle (K1,K2)} in 2 n + 1 {\displaystyle 2^{n+1}} steps, instead of the 2 2 n {\displaystyle 2^{2n}} steps one would expect from an ideally secure algorithm with 2 n {\displaystyle 2n} bits of key.

Therefore, Triple DES uses a "key bundle" that comprises three DES keys , K 1 {\displaystyle K1} , K 2 {\displaystyle K2} and K 3 {\displaystyle K3} , each of 56 bits (excluding parity bits ). The encryption algorithm is:

That is, encrypt with K 1 {\displaystyle K1} , decrypt with K 2 {\displaystyle K2} , then encrypt with K 3 {\displaystyle K3} .

Decryption is the reverse:

That is, decrypt with K 3 {\displaystyle K3} , encrypt with K 2 {\displaystyle K2} , then decrypt with K 1 {\displaystyle K1} .

Each triple encryption encrypts one block of 64 bits of data.

In each case, the middle operation is the reverse of the first and last. This improves the strength of the algorithm when using keying option 2 and provides backward compatibility with DES with keying option 3.

The standards define three keying options:

This is the strongest, with 3 × 56 = 168 independent key bits. It is still vulnerable to the meet-in-the-middle attack , but the attack requires 2 steps.

This provides a shorter key length of 56*2 or 112 bits and a reasonable compromise between DES and keying option 1, with the same caveat as above. This is an improvement over "double DES" which only requires 2 steps to attack. NIST disallowed this option in 2015.

This is backward-compatible with DES, since two of the operations cancel out. ISO/IEC 18033-3 never allowed this option, and NIST no longer allows K 1 = K 2 or K 2 = K 3 .

Each DES key is 8 odd-parity bytes, with 56 bits of key and 8 bits of error-detection. A key bundle requires 24 bytes for option 1, 16 for option 2, or 8 for option 3.

NIST (and the current TCG specifications version 2.0 of approved algorithms for Trusted Platform Module ) also disallows using any one of the 64 following 64-bit values in any keys (note that 32 of them are the binary complement of the 32 others; and that 32 of these keys are also the reverse permutation of bytes of the 32 others), listed here in hexadecimal (in each byte, the least significant bit is an odd-parity generated bit, which is discarded when forming the effectively 56-bit key):

With these restrictions on allowed keys, Triple DES was reapproved with keying options 1 and 2 only. Generally, the three keys are generated by taking 24 bytes from a strong random generator, and only keying option 1 should be used (option 2 needs only 16 random bytes, but strong random generators are hard to assert and it is considered best practice to use only option 1).

As with all block ciphers, encryption and decryption of multiple blocks of data may be performed using a variety of modes of operation , which can generally be defined independently of the block cipher algorithm. However, ANS X9.52 specifies directly, and NIST SP 800-67 specifies via SP 800-38A, that some modes shall only be used with certain constraints on them that do not necessarily apply to general specifications of those modes. For example, ANS X9.52 specifies that for cipher block chaining , the initialization vector shall be different each time, whereas ISO/IEC 10116 does not. FIPS PUB 46-3 and ISO/IEC 18033-3 define only the single-block algorithm, and do not place any restrictions on the modes of operation for multiple blocks.

In general, Triple DES with three independent keys ( keying option 1) has a key length of 168 bits (three 56-bit DES keys), but due to the meet-in-the-middle attack , the effective security it provides is only 112 bits. Keying option 2 reduces the effective key size to 112 bits (because the third key is the same as the first). However, this option is susceptible to certain chosen-plaintext or known-plaintext attacks, and thus it is designated by NIST to have only 80 bits of security . This can be considered insecure; as a consequence, Triple DES's planned deprecation was announced by NIST in 2017.

The short block size of 64 bits makes 3DES vulnerable to block collision attacks if it is used to encrypt large amounts of data with the same key. The Sweet32 attack shows how this can be exploited in TLS and OpenVPN. Practical Sweet32 attack on 3DES-based cipher-suites in TLS required 2 36.6 {\displaystyle 2^{36.6}} blocks (785 GB) for a full attack, but researchers were lucky to get a collision just after around 2 20 {\displaystyle 2^{20}} blocks, which took only 25 minutes.

The security of TDEA is affected by the number of blocks processed with one key bundle. One key bundle shall not be used to apply cryptographic protection (e.g., encrypt) more than 2 20 {\displaystyle 2^{20}} 64-bit data blocks.

OpenSSL does not include 3DES by default since version 1.1.0 (August 2016) and considers it a "weak cipher".

As of 2008, the electronic payment industry uses Triple DES and continues to develop and promulgate standards based upon it, such as EMV .

Earlier versions of Microsoft OneNote , Microsoft Outlook 2007 and Microsoft System Center Configuration Manager 2012 use Triple DES to password-protect user content and system data. However, in December 2018, Microsoft announced the retirement of 3DES throughout their Office 365 service.

Firefox and Mozilla Thunderbird use Triple DES in CBC mode to encrypt website authentication login credentials when using a master password.

Below is a list of cryptography libraries that support Triple DES:

Some implementations above may not include 3DES in the default build, in later or more recent versions.