In signal processing , the Wiener filter is a filter used to produce an estimate of a desired or target random process by linear time-invariant ( LTI ) filtering of an observed noisy process, assuming known stationary signal and noise spectra, and additive noise. The Wiener filter minimizes the mean square error between the estimated random process and the desired process.

The goal of the Wiener filter is to compute a statistical estimate of an unknown signal using a related signal as an input and filtering that known signal to produce the estimate as an output.  For example, the known signal might consist of an unknown signal of interest that has been corrupted by additive noise .  The Wiener filter can be used to filter out the noise from the corrupted signal to provide an estimate of the underlying signal of interest.  The Wiener filter is based on a statistical approach, and a more statistical account of the theory is given in the minimum mean square error (MMSE) estimator article.

Typical deterministic filters are designed for a desired frequency response .  However, the design of the Wiener filter takes a different approach.  One is assumed to have knowledge of the spectral properties of the original signal and the noise, and one seeks the linear time-invariant filter whose output would come as close to the original signal as possible.  Wiener filters are characterized by the following:

This filter is frequently used in the process of deconvolution ; for this application, see Wiener deconvolution .

Let s ( t + α ) {\displaystyle s(t+\alpha )} be an unknown signal which must be estimated from a measurement signal x ( t ) {\displaystyle x(t)} .  Where alpha is a tunable parameter. α > 0 {\displaystyle \alpha >0} is known as prediction, α = 0 {\displaystyle \alpha =0} is known as filtering, and α < 0 {\displaystyle \alpha <0} is known as smoothing (see Wiener filtering chapter of for more details).

The Wiener filter problem has solutions for three possible cases:  one where a noncausal filter is acceptable (requiring an infinite amount of both past and future data), the case where a causal filter is desired (using an infinite amount of past data), and the finite impulse response (FIR) case where only input data is used (i.e. the result or output is not fed back into the filter as in the IIR case). The first case is simple to solve but is not suited for real-time applications.  Wiener's main accomplishment was solving the case where the causality requirement is in effect; Norman Levinson gave the FIR solution in an appendix of Wiener's book.

where S {\displaystyle S} are spectral densities .  Provided that g ( t ) {\displaystyle g(t)} is optimal, then the minimum mean-square error equation reduces to

and the solution g ( t ) {\displaystyle g(t)} is the inverse two-sided Laplace transform of G ( s ) {\displaystyle G(s)} .

where

This general formula is complicated and deserves a more detailed explanation. To write down the solution G ( s ) {\displaystyle G(s)} in a specific case, one should follow these steps:

The causal finite impulse response (FIR) Wiener filter, instead of using some given data matrix X and output vector Y, finds optimal tap weights by using the statistics of the input and output signals. It populates the input matrix X with estimates of the auto-correlation of the input signal (T) and populates the output vector Y with estimates of the cross-correlation between the output and input signals (V).

In order to derive the coefficients of the Wiener filter, consider the signal w [ n ] being fed to a Wiener filter of order (number of past taps) N and with coefficients { a 0 , ⋯ , a N } {\displaystyle \{a_{0},\cdots ,a_{N}\}} . The output of the filter is denoted x [ n ] which is given by the expression

The residual error is denoted e [ n ] and is defined as e [ n ] = x [ n ] − s [ n ] (see the corresponding block diagram). The Wiener filter is designed so as to minimize the mean square error ( MMSE criteria) which can be stated concisely as follows:

where E [ ⋅ ] {\displaystyle E[\cdot ]} denotes the expectation operator. In the general case, the coefficients a i {\displaystyle a_{i}} may be complex and may be derived for the case where w [ n ] and s [ n ] are complex as well. With a complex signal, the matrix to be solved is a Hermitian Toeplitz matrix , rather than symmetric Toeplitz matrix .  For simplicity, the following considers only the case where all these quantities are real. The mean square error (MSE) may be rewritten as:

To find the vector [ a 0 , … , a N ] {\displaystyle [a_{0},\,\ldots ,\,a_{N}]} which minimizes the expression above, calculate its derivative with respect to each a i {\displaystyle a_{i}}

Assuming that w [ n ] and s [ n ] are each stationary and jointly stationary, the sequences R w [ m ] {\displaystyle R_{w}[m]} and R w s [ m ] {\displaystyle R_{ws}[m]} known respectively as the autocorrelation of w [ n ] and the cross-correlation between w [ n ] and s [ n ] can be defined as follows:

The derivative of the MSE may therefore be rewritten as:

Note that for real w [ n ] {\displaystyle w[n]} , the autocorrelation is symmetric: R w [ j − i ] = R w [ i − j ] {\displaystyle R_{w}[j-i]=R_{w}[i-j]} Letting the derivative be equal to zero results in:

which can be rewritten (using the above symmetric property) in matrix form

These equations are known as the Wiener–Hopf equations . The matrix T appearing in the equation is a symmetric Toeplitz matrix . Under suitable conditions on R {\displaystyle R} , these matrices are known to be positive definite and therefore non-singular yielding a unique solution to the determination of the Wiener filter coefficient vector, a = T − 1 v {\displaystyle \mathbf {a} =\mathbf {T} ^{-1}\mathbf {v} } . Furthermore, there exists an efficient algorithm to solve such Wiener–Hopf equations known as the Levinson-Durbin algorithm so an explicit inversion of T is not required.

In some articles, the cross correlation function is defined in the opposite way: R s w [ m ] = E { w [ n ] s [ n + m ] } {\displaystyle R_{sw}[m]=E\{w[n]s[n+m]\}} Then, the v {\displaystyle \mathbf {v} } matrix will contain R s w [ 0 ] … R s w [ N ] {\displaystyle R_{sw}[0]\ldots R_{sw}[N]} ; this is just a difference in notation.

Whichever notation is used, note that for real w [ n ] , s [ n ] {\displaystyle w[n],s[n]} : R s w [ k ] = R w s [ − k ] {\displaystyle R_{sw}[k]=R_{ws}[-k]}

The realization of the causal Wiener filter looks a lot like the solution to the least squares estimate, except in the signal processing domain. The least squares solution, for input matrix X {\displaystyle \mathbf {X} } and output vector y {\displaystyle \mathbf {y} } is

The FIR Wiener filter is related to the least mean squares filter , but minimizing the error criterion of the latter does not rely on cross-correlations or auto-correlations. Its solution converges to the Wiener filter solution.

For complex signals, the derivation of the complex Wiener filter is performed by minimizing E [ | e [ n ] | 2 ] {\displaystyle E\left[|e[n]|^{2}\right]} = E [ e [ n ] e ∗ [ n ] ] {\displaystyle E\left[e[n]e^{*}[n]\right]} .  This involves computing partial derivatives with respect to both the real and imaginary parts of a i {\displaystyle a_{i}} , and requiring them both to be zero.

The resulting Wiener-Hopf equations are:

which can be rewritten in matrix form:

Note here that: R w [ − k ] = R w ∗ [ k ] R s w [ k ] = R w s ∗ [ − k ] {\displaystyle {\begin{aligned}R_{w}[-k]&=R_{w}^{*}[k]\\R_{sw}[k]&=R_{ws}^{*}[-k]\end{aligned}}}

The Wiener coefficient vector is then computed as: a = ( T − 1 v ) ∗ {\displaystyle \mathbf {a} ={(\mathbf {T} ^{-1}\mathbf {v} )}^{*}}

The Wiener filter has a variety of applications in signal processing, image processing, control systems, and digital communications.  These applications generally fall into one of four main categories:

For example, the Wiener filter can be used in image processing to remove noise from a picture. For example, using the Mathematica function: WienerFilter[image,2] on the first image on the right, produces the filtered image below it.

It is commonly used to denoise audio signals, especially speech, as a preprocessor before speech recognition .

The filter was proposed by Norbert Wiener during the 1940s and published in 1949. The discrete-time equivalent of Wiener's work was derived independently by Andrey Kolmogorov and published in 1941. Hence the theory is often called the Wiener–Kolmogorov filtering theory ( cf. Kriging ).  The Wiener filter was the first statistically designed filter to be proposed and subsequently gave rise to many others including the Kalman filter .