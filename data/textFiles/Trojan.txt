In computing , a Trojan horse (or simply Trojan )   is any malware that misleads users of its true intent by disguising itself as a standard program. The term is derived from the ancient Greek story of the deceptive Trojan Horse that led to the fall of the city of Troy .

Trojans are generally spread by some form of social engineering . For example, where a user is duped into executing an email attachment disguised to appear innocuous (e.g., a routine form to be filled in), or by clicking on a fake advertisement on social media or anywhere else. Although their payload can be anything, many modern forms act as a backdoor , contacting a controller who can then have unauthorized access to the affected computer. Ransomware attacks are often carried out using a Trojan.

Unlike computer viruses and worms , Trojans generally do not attempt to inject themselves into other files or otherwise propagate themselves.

It is not clear where or when the concept, and this term for it, was first used, but by 1971 the first Unix manual assumed its readers knew both:

Another early reference is in a US Air Force report in 1974 on the analysis of vulnerability in the Multics computer systems.

It was made popular by Ken Thompson in his 1983 Turing Award acceptance lecture "Reflections on Trusting Trust", subtitled: "To what extent should one trust a statement that a program is free of Trojan horses?  Perhaps it is more important to trust the people who wrote the software." He mentioned that he knew about the possible existence of Trojans from a report on the security of Multics.

Once installed, Trojans may perform a range of malicious actions. Many tend to contact one or more Command and Control (C2) servers across the Internet and await instruction. Since individual Trojans typically use a specific set of ports for this communication, it can be relatively simple to detect them. Moreover, other malware could potentially "take over" the Trojan, using it as a proxy for malicious action.

In German-speaking countries, spyware used or made by the government is sometimes called govware . Govware is typically a Trojan software used to intercept communications from the target computer. Some countries like Switzerland and Germany have a legal framework governing the use of such software. Examples of govware Trojans include the Swiss MiniPanzer and MegaPanzer and the German "state Trojan" nicknamed R2D2 . German govware works by exploiting security gaps unknown to the general public and accessing smartphone data before it becomes encrypted via other applications.

Due to the popularity of botnets among hackers and the availability of advertising services that permit authors to violate their users' privacy, Trojans are becoming more common. According to a survey conducted by BitDefender from January to June 2009, "Trojan-type malware is on the rise, accounting for 83% of the global malware detected in the world." Trojans have a relationship with worms, as they spread with the help given by worms and travel across the internet with them. BitDefender has stated that approximately 15% of computers are members of a botnet, usually recruited by a Trojan infection.

Recent investigations have revealed that the Trojan horse method has been used as an attack on cloud computing systems. A Trojan attack on cloud systems tries to insert an application or service into the system that can impact the cloud services by changing or stopping the functionalities. When the cloud system identifies the attacks as legitimate, the service or application is performed which can damage and infect the cloud system.

A Trojan horse is a program that purports to perform some legitimate function, yet upon execution it compromises the user's security. A simple example is the following malicious version of the Linux sudo command. An attacker would place this script in a publicly writable directory (e.g., /tmp ). If an administrator happens to be in this directory and executes sudo , then the Trojan may execute, compromising the administrator's password.

To prevent a sudo Trojan horse , set the . entry in the PATH environment variable to be located at the tail end. For example: PATH=/usr/local/bin:/usr/bin:. .

Having . somewhere in the PATH is convenient, but there is a catch. Another example is the following malicious version of the Linux ls command. However, the filename is not ls ; instead, it is sl . An attacker would place this script in a publicly writable directory (e.g., /tmp ).

To prevent a malicious programmer from anticipating this common typing mistake:

The computer term "Trojan horse" is derived from the legendary Trojan Horse of the ancient city of Troy . For this reason "Trojan" is often capitalized. However, while style guides and dictionaries differ, many suggest a lower case "trojan" for normal use.