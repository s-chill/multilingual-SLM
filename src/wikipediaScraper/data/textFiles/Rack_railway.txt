A rack railway (also rack-and-pinion railway , cog railway , or cogwheel railway ) is a steep grade railway with a toothed rack rail , usually between the running rails . The trains are fitted with one or more cog wheels or pinions that mesh with this rack rail. This allows the trains to operate on steep gradients of 100% (45 degrees) or more, well above the 10% maximum for friction-based rail .  The rack and pinion mechanism also provides more controlled braking and reduces the effects of snow or ice on the rails.  Most rack railways are mountain railways , although a few are transit railways or tramways built to overcome a steep gradient in an urban environment.
The first cog railway was the Middleton Railway between Middleton and Leeds in West Yorkshire , England, United Kingdom , where the first commercially successful steam locomotive , Salamanca , ran in 1812. This used a rack and pinion system designed and patented in 1811 by John Blenkinsop .

The first mountain cog railway was the Mount Washington Cog Railway in the U.S. state of New Hampshire , which carried its first fare-paying passengers in 1868. The track was completed to reach the summit of Mount Washington in 1869. The first mountain rack railway in continental Europe was the Vitznau-Rigi-Bahn on Mount Rigi in Switzerland , which opened in 1871. Both lines are still running.

As well as the rack system used, lines using rack systems fall into one of two categories depending on whether the rack rail is continuous or not. Lines where the rack rail is continuous, and the cog-drive is used throughout, are described as pure-rack lines. Other lines, which use the cog drive only on the steepest sections and elsewhere operate as a regular railway, are described as rack-and-adhesion lines.

On rack-and-adhesion lines, trains are equipped with propulsion and braking systems capable of acting both through the running rail wheels and the cog wheels, depending on whether the rack rail is present or not. Rack-and-adhesion lines also need to use a system for smoothing the transition from friction to rack traction, with a spring-mounted rack section to bring the pinion teeth gradually into engagement. This was invented by Roman Abt, who also invented the Abt rack system.

On pure-rack lines, the train's running rail wheels are only used to carry the train and do not contribute to propulsion or braking, which is exclusively done through the cog wheels. Pure-rack lines have no need of transitioning systems, as the cog wheels remain engaged with the rack rail at all times, but all track, including sidings and depots, must be equipped with rack rail irrespective of gradient.

A number of different designs of rack rail and matching cog wheel have been developed over the years. With the exception of some early Morgan and Blenkinsop rack installations, rack systems place the rack rail halfway between the running rails, mounted on the same sleepers or ties as the running rails.

John Blenkinsop thought that the friction would be too low from metal wheels on metal rails even on level ground, so he built his steam locomotives for the Middleton Railway in 1812 with a 20- tooth , 3-foot (914 mm) diameter cog wheel (pinion) on the left side that engaged in rack teeth (two teeth per foot) on the outer side of the rail, the metal "fishbelly" edge rail with its side rack being cast all in one piece, in 3-foot (1 yd; 914 mm) lengths. Blenkinsop's system remained in use for 25 years on the Middleton Railway, but it became a curiosity because simple friction was found to be sufficient for railroads operating on level ground.

The Fell mountain railway system, developed in the 1860s, is not strictly speaking a rack railway, since there are no cogs with teeth.  Rather, this system uses a smooth raised centre rail between the two running rails on steep sections of lines that is gripped on both sides to improve friction.  Trains are propelled by wheels or braked by shoes pressed horizontally onto the centre rail, as well as by means of the normal running wheels.

The first successful rack railway in the United States was the Mount Washington Cog Railway, developed by Sylvester Marsh . Marsh was issued a U.S. patent for the general idea of a rack railway in September 1861, and in January 1867 for a practical rack where the rack teeth take the form of rollers arranged like the rungs of a ladder between two L-shaped wrought-iron rails. The first public trial of the Marsh rack on Mount Washington was made on August 29, 1866, when only one quarter of a mile (402 meters) of track had been completed.  The Mount Washington railway opened to the public on August 14, 1868. The pinion wheels on the locomotives have deep teeth that ensure that at least two teeth are engaged with the rack at all times; this measure helps reduce the possibility of the pinions riding up and out of the rack.

The Riggenbach rack system was invented by Niklaus Riggenbach working at about the same time as, but independently from Marsh. Riggenbach was granted a French patent in 1863 based on a working model which he used to interest potential Swiss backers. During this time, the Swiss Consul to the United States visited Marsh's Mount Washington Cog Railway and reported back with enthusiasm to the Swiss government. Eager to boost tourism in Switzerland, the government commissioned Riggenbach to build a rack railway up Mount Rigi . Following the construction of a prototype locomotive and test track in a quarry near Bern , the Vitznau–Rigi railway opened on 22 May 1871.

The Riggenbach system is similar in design to the Marsh system. It uses a ladder rack, formed of steel plates or channels connected by round or square rods at regular intervals. The Riggenbach system suffers from the problem that its fixed ladder rack is more complex and expensive to build than the other systems.

Following the success of the Vitznau–Rigi railway, Riggenbach established the Maschinenfabrik der Internationalen Gesellschaft für Bergbahnen (IGB) – a company that produced rack locomotives to his design.

The Abt system was devised by Carl Roman Abt , a Swiss locomotive engineer. Abt worked for Riggenbach at his works in Olten and later at his IGB rack locomotive company. In 1885, he founded his own civil engineering company.

During the early 1880s, Abt worked to devise an improved rack system that overcame the limitations of the Riggenbach system. In particular, the Riggenbach rack was expensive to manufacture and maintain and the switches were complex. In 1882, Abt designed a new rack using solid bars with vertical teeth machined into them. Two or three of these bars are mounted centrally between the rails, with the teeth of the pinions rotationally offset from each other to match. The use of multiple bars with offset teeth ensures that the pinions on the locomotive driving wheels are constantly engaged with the rack. The Abt system is cheaper to build than the Riggenbach because it requires a lower weight of rack over a given length. However the Riggenbach system exhibits greater wear resistance than the Abt.

The first use of the Abt system was on the Harzbahn in Germany, which opened in 1885. The Abt system was also used for the construction of the Snowdon Mountain Railway in Wales from 1894 to 1896.

The pinion wheels can be mounted on the same axle as the rail wheels, or driven separately.  The steam locomotives on the West Coast Wilderness Railway have separate cylinders driving the pinion wheel, as do the "X"-class locomotives on the Nilgiri Mountain Railway .

The Agudio rack system was invented by Tommaso Agudio. Its only long-lived application was on the Sassi–Superga tramway which opened in 1884. It used a vertical rack with cog wheels on each side of the central rack. Its unique feature, however, was that the 'locomotive' was propelled by means of an endless cable driven from an engine house at the foot of the incline. It was converted to use the Strub rack system in 1934.

The Locher rack system, invented by Eduard Locher , has gear teeth cut in the sides rather than the top of the rail, engaged by two cog wheels on the locomotive.  This system allows use on steeper grades than the other systems, whose teeth could jump out of the rack.  It is used on the Pilatus Railway .

Locher set out to design a rack system that could be used on gradients as steep as 1 in 2 (50%). The Abt system – the most common rack system in Switzerland at the time – was limited to a maximum gradient of 1 in 4 (25%). Locher showed that on steeper grade, the Abt system was prone to the driving pinion over-riding the rack, causing potentially catastrophic derailments, as predicted by Dr. Abt.  To overcome this problem and allow a rack line up the steep sides of Mt. Pilatus , Locher developed a rack system where the rack is a flat bar with symmetrical, horizontal teeth. Horizontal pinions with flanges below the rack engage the centrally-mounted bar, both driving the locomotive and keeping it centered on the track.

This system provides very stable attachment to the track, also protecting the car from toppling over even under the most severe crosswinds. Such gears are also capable of leading the car, so even flanges on running wheels are optional. The biggest shortcoming of the system is that the standard railway switch is not usable, and a transfer table or other complex device must be used where branching of the track is needed.

Following tests, the Locher system was deployed on the Pilatus Railway, which opened in 1889. No other public railway uses the Locher system, although some European coal mines use a similar system on steeply graded underground lines.

The Strub rack system was invented by Emil Strub in 1896. It uses a rolled flat-bottom rail with rack teeth machined into the head approximately 100 mm (3.9 inches) apart. Safety jaws fitted to the locomotive engage with the underside of the head to prevent derailments and serve as a brake. Strub's U.S. patent, granted in 1898, also includes details of how the rack rail is integrated with the mechanism of a turnout .

The best-known use of the Strub system is on the Jungfraubahn in Switzerland.

Strub is the simplest rack system to maintain and has become increasingly popular.

In 1900, E. C. Morgan of Chicago received a patent on a rack railway system that was mechanically similar to the Riggenbach rack, but where the rack was also used as a third rail to power the electric locomotive. Morgan went on to develop heavier locomotives and with J. H. Morgan, turnouts for this system. In 1904, he patented a simplified but compatible rack, where the teeth on the engine pinions engaged square holes punched in a bar-shaped center rail. J. H. Morgan patented several alternative turnout designs for use with this rack system. Curiously, Morgan recommended an off-center rack in order to allow clear passage for pedestrians and animals walking along the tracks. Some photos of early Morgan installations show this. A simplified rack mounting system could be used when the Morgan rack was not used for third-rail power and the Morgan rack offered interesting possibilities for street railways. The Morgan rack was good for grades of up to 16 percent .

The Goodman Equipment Company began marketing the Morgan system for mine railways , and it saw widespread use, particularly where steep grades were encountered underground. By 1907, Goodman had offices in Cardiff, Wales , to serve the British market. Between 1903 and 1909, the McKell Coal and Coke company in Raleigh County, West Virginia, installed 35,000 feet (10,700 m) of Morgan rack/third-rail track in its mines. Between 1905 and 1906, the Mammoth Vein Coal Company installed 8,200 feet (2,500 m) of powered rack in two of its mines in Everist, Iowa , with a maximum grade of 16%. The Donohoe Coke Co. of Greenwald, Pennsylvania had 10,000 feet (3,050 m) of Goodman rack in its mine in 1906. The Morgan system saw limited use on one common carrier railroad in the United States, the Chicago Tunnel Company , a narrow gauge freight carrier that had one steep grade in the line up to their surface disposal station on the Chicago lakefront.

The Lamella system (also known as the Von Roll system) was developed by the Von Roll company after the rolled steel rails used in the Strub system became unavailable. It is formed from a single blade cut in a similar shape to the Abt system, but typically wider than a single Abt bar. The Lamella rack can be used by locomotives designed for use on the Riggenbach or the Strub systems, so long as the safety-jaws that were a feature of the original Strub system are not used. Some railways use racks from multiple systems; for example, the St. Gallen Gais Appenzell Railway in Switzerland has sections of Riggenbach, Strub, and Lamella rack.

Most of the rack railways built from the late 20th century onwards have used the Lamella system.

Rack railway switches are as varied as rack railway technologies, for optional rack lines such as the Zentralbahn in Switzerland and the West Coast Wilderness Railway in Tasmania it is convenient to only use switches on sections flat enough for adhesion (for example, on a pass summit). Other systems which rely on the rack for driving (with the conventional rail wheels undriven) such as the Dolderbahn in Zürich , Štrbské Pleso in Slovakia and the Schynige Platte rack railway instead must switch the rack rail. The Dolderbahn switch works by bending all three rails, an operation that is performed every trip as the two trains pass in the middle.

The geometry of the rack system has a large impact on the construction of turnouts. If the rack is elevated above the running rails, there is no need to interrupt the running rails to allow passage of the driving pinions of the engines. Strub explicitly documented this in his U.S. patent. Strub used a complex set of bell-cranks and push-rods linking the throw-rod for the points to the two throw-rods for the moving rack sections. One break in the rack was required to select between the two routes, and a second break was required where the rack rails cross the running rails. Turnouts for the Morgan Rack system were similar, with the rack elevated above the running rails. Most of the Morgan turnout patents included movable rack sections to avoid breaks in the rack, but because all Morgan locomotives had two linked drive pinions, there was no need for a continuous rack. So long as the breaks in the rack were shorter than the distance between the drive pinions on the locomotive, the rack rail could be interrupted wherever there was need to cross over a running rail.

Turnouts are far more complex when the rack is at or below the level of the running rails. Marsh's first rack patent shows such an arrangement, and the original Mount Washington Cog Railway he built had no turnouts. It was not until 1941 that a turnout was constructed on this line. There were more turnouts built for the line but all were hand operated. In 2003, a new automatic hydraulic turnout was developed and built at the base as a prototype. With the success of the new turnout, more new automatic hydraulic turnouts were built to replace the hand-operated ones. The new turnouts installed on the Mount Washington line in 2007 are essentially transfer tables . The Locher rack also requires transfer tables.

Originally almost all cog railways were powered by steam locomotives . The steam locomotive needs to be extensively modified to work effectively in this environment. Unlike a diesel locomotive or electric locomotive , the steam locomotive only works when its powerplant (the boiler, in this case) is fairly level. The locomotive boiler requires water to cover the boiler tubes and firebox sheets at all times, particularly the crown sheet , the metal top of the firebox. If this is not covered with water, the heat of the fire will soften it enough to give way under the boiler pressure, leading to a catastrophic failure.

On rack systems with extreme gradients, the boiler, cab, and general superstructure of the locomotive are tilted forward relative to the wheels so that they are more or less horizontal when on the steeply graded track. These locomotives often cannot function on level track, and so the entire line, including maintenance shops, must be laid on a gradient. This is one of the reasons why rack railways were among the first to be electrified and most of today's rack railways are electrically powered. In some cases, a vertical boiler can be used that is less sensitive for the track gradient.

On a rack-only railroad, locomotives are always downward of their passenger cars for safety reasons: the locomotive is fitted with powerful brakes, often including hooks or clamps that grip the rack rail solidly. Some locomotives are fitted with automatic brakes that apply if the speed gets too high, preventing runaways. Often there is no coupler between locomotive and train since gravity will always push the passenger car down against the locomotive. Electrically powered vehicles often have electromagnetic track brakes as well.

The maximum speed of trains operating on a cog railway is very low, generally from 9 to 25 kilometres per hour (5.6 to 15.5 mph) depending on gradient and propulsion method. Because the Skitube has gentler gradients than typical, its speeds are higher than typical.

The Culdee Fell Railway is a fictional cog railway on the Island of Sodor in The Railway Series by Rev. W. Awdry . Its operation, locomotives and history are based on those of the Snowdon Mountain Railway . It is featured in the book Mountain Engines . The Štrbské Pleso rack railway in Slovakia is featured in "The Bounty" by Janet Evanovich and Steve Hamilton .